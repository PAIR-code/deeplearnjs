{"dependencies":[{"name":"/usr/local/google/home/nsthorat/deeplearnjs-clients/float16/tfjs-core/tsconfig.json","includedInParent":true,"mtime":1532457398879},{"name":"/usr/local/google/home/nsthorat/deeplearnjs-clients/float16/tfjs-core/test/package.json","includedInParent":true,"mtime":1530637734514}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Conv2DProgram = function () {\n    function Conv2DProgram(convInfo) {\n        this.variableNames = ['x', 'W'];\n        this.outputShape = convInfo.outShape;\n        var padTop = convInfo.padInfo.top;\n        var padLeft = convInfo.padInfo.left;\n        var strideHeight = convInfo.strideHeight;\n        var strideWidth = convInfo.strideWidth;\n        var dilationHeight = convInfo.dilationHeight;\n        var dilationWidth = convInfo.dilationWidth;\n        var filterHeight = convInfo.filterHeight;\n        var filterWidth = convInfo.filterWidth;\n        var inputDepthNearestVec4 = Math.floor(convInfo.inChannels / 4) * 4;\n        var inputDepthVec4Remainder = convInfo.inChannels % 4;\n        this.userCode = \"\\n      const ivec2 strides = ivec2(\" + strideHeight + \", \" + strideWidth + \");\\n      const ivec2 pads = ivec2(\" + padTop + \", \" + padLeft + \");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d2 = coords[3];\\n\\n        ivec2 xRCCorner = coords.yz * strides - pads;\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \" + filterHeight + \"; wR++) {\\n          int xR = xRCorner + wR * \" + dilationHeight + \";\\n\\n          if (xR < 0 || xR >= \" + convInfo.inHeight + \") {\\n            continue;\\n          }\\n\\n          for (int wC = 0; wC < \" + filterWidth + \"; wC++) {\\n            int xC = xCCorner + wC * \" + dilationWidth + \";\\n\\n            if (xC < 0 || xC >= \" + convInfo.inWidth + \") {\\n              continue;\\n            }\\n\\n            for (int d1 = 0; d1 < \" + inputDepthNearestVec4 + \"; d1 += 4) {\\n              vec4 xValues = vec4(\\n                getX(batch, xR, xC, d1),\\n                getX(batch, xR, xC, d1 + 1),\\n                getX(batch, xR, xC, d1 + 2),\\n                getX(batch, xR, xC, d1 + 3)\\n              );\\n              vec4 wValues = vec4(\\n                getW(wR, wC, d1, d2),\\n                getW(wR, wC, d1 + 1, d2),\\n                getW(wR, wC, d1 + 2, d2),\\n                getW(wR, wC, d1 + 3, d2)\\n              );\\n\\n              dotProd += dot(xValues, wValues);\\n            }\\n\\n            if (\" + (inputDepthVec4Remainder === 1) + \") {\\n              dotProd +=\\n                getX(batch, xR, xC, \" + inputDepthNearestVec4 + \") *\\n                getW(wR, wC, \" + inputDepthNearestVec4 + \", d2);\\n            } else if (\" + (inputDepthVec4Remainder === 2) + \") {\\n              vec2 xValues = vec2(\\n                getX(batch, xR, xC, \" + inputDepthNearestVec4 + \"),\\n                getX(batch, xR, xC, \" + inputDepthNearestVec4 + \" + 1)\\n              );\\n              vec2 wValues = vec2(\\n                getW(wR, wC, \" + inputDepthNearestVec4 + \", d2),\\n                getW(wR, wC, \" + inputDepthNearestVec4 + \" + 1, d2)\\n              );\\n              dotProd += dot(xValues, wValues);\\n            } else if (\" + (inputDepthVec4Remainder === 3) + \") {\\n              vec3 xValues = vec3(\\n                getX(batch, xR, xC, \" + inputDepthNearestVec4 + \"),\\n                getX(batch, xR, xC, \" + inputDepthNearestVec4 + \" + 1),\\n                getX(batch, xR, xC, \" + inputDepthNearestVec4 + \" + 2)\\n              );\\n              vec3 wValues = vec3(\\n                getW(wR, wC, \" + inputDepthNearestVec4 + \", d2),\\n                getW(wR, wC, \" + inputDepthNearestVec4 + \" + 1, d2),\\n                getW(wR, wC, \" + inputDepthNearestVec4 + \" + 2, d2)\\n              );\\n              dotProd += dot(xValues, wValues);\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \";\n    }\n    return Conv2DProgram;\n}();\nexports.Conv2DProgram = Conv2DProgram;","map":{"mappings":[{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":4,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":4,"column":4}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":4,"column":20}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":4,"column":32}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":26,"column":2},"generated":{"line":5,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":26,"column":2},"generated":{"line":5,"column":13}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":26,"column":2},"generated":{"line":5,"column":26}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":26,"column":14},"generated":{"line":5,"column":27}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":26,"column":2},"generated":{"line":5,"column":35}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":26,"column":34},"generated":{"line":5,"column":37}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":2},"generated":{"line":6,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":2},"generated":{"line":6,"column":13}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":2},"generated":{"line":6,"column":26}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":18},"generated":{"line":6,"column":29}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":19},"generated":{"line":6,"column":30}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":18},"generated":{"line":6,"column":33}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":24},"generated":{"line":6,"column":35}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":18},"generated":{"line":6,"column":38}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":22,"column":2},"generated":{"line":6,"column":39}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":27,"column":4},"generated":{"line":7,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":27,"column":9},"generated":{"line":7,"column":13}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":27,"column":4},"generated":{"line":7,"column":24}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":27,"column":23},"generated":{"line":7,"column":27}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":27,"column":32},"generated":{"line":7,"column":36}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":27,"column":4},"generated":{"line":7,"column":44}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":28,"column":4},"generated":{"line":8,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":28,"column":10},"generated":{"line":8,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":28,"column":19},"generated":{"line":8,"column":21}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":28,"column":28},"generated":{"line":8,"column":30}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":28,"column":19},"generated":{"line":8,"column":37}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":28,"column":36},"generated":{"line":8,"column":38}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":28,"column":4},"generated":{"line":8,"column":41}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":29,"column":4},"generated":{"line":9,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":29,"column":10},"generated":{"line":9,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":29,"column":20},"generated":{"line":9,"column":22}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":29,"column":29},"generated":{"line":9,"column":31}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":29,"column":20},"generated":{"line":9,"column":38}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":29,"column":37},"generated":{"line":9,"column":39}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":29,"column":4},"generated":{"line":9,"column":43}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":30,"column":4},"generated":{"line":10,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":30,"column":10},"generated":{"line":10,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":30,"column":25},"generated":{"line":10,"column":27}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":30,"column":34},"generated":{"line":10,"column":36}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":30,"column":4},"generated":{"line":10,"column":48}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":31,"column":4},"generated":{"line":11,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":31,"column":10},"generated":{"line":11,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":31,"column":24},"generated":{"line":11,"column":26}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":31,"column":33},"generated":{"line":11,"column":35}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":31,"column":4},"generated":{"line":11,"column":46}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":32,"column":4},"generated":{"line":12,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":32,"column":10},"generated":{"line":12,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":32,"column":27},"generated":{"line":12,"column":29}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":32,"column":36},"generated":{"line":12,"column":38}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":32,"column":4},"generated":{"line":12,"column":52}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":33,"column":4},"generated":{"line":13,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":33,"column":10},"generated":{"line":13,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":33,"column":26},"generated":{"line":13,"column":28}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":33,"column":35},"generated":{"line":13,"column":37}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":33,"column":4},"generated":{"line":13,"column":50}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":34,"column":4},"generated":{"line":14,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":34,"column":10},"generated":{"line":14,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":34,"column":25},"generated":{"line":14,"column":27}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":34,"column":34},"generated":{"line":14,"column":36}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":34,"column":4},"generated":{"line":14,"column":48}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":35,"column":4},"generated":{"line":15,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":35,"column":10},"generated":{"line":15,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":35,"column":24},"generated":{"line":15,"column":26}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":35,"column":33},"generated":{"line":15,"column":35}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":35,"column":4},"generated":{"line":15,"column":46}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":4},"generated":{"line":16,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":10},"generated":{"line":16,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":34},"generated":{"line":16,"column":36}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":39},"generated":{"line":16,"column":41}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":34},"generated":{"line":16,"column":46}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":45},"generated":{"line":16,"column":47}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":54},"generated":{"line":16,"column":56}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":45},"generated":{"line":16,"column":66}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":67},"generated":{"line":16,"column":69}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":34},"generated":{"line":16,"column":70}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":72},"generated":{"line":16,"column":74}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":37,"column":4},"generated":{"line":16,"column":75}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":38,"column":4},"generated":{"line":17,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":38,"column":10},"generated":{"line":17,"column":12}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":38,"column":36},"generated":{"line":17,"column":38}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":38,"column":45},"generated":{"line":17,"column":47}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":38,"column":36},"generated":{"line":17,"column":57}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":38,"column":58},"generated":{"line":17,"column":60}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":38,"column":4},"generated":{"line":17,"column":61}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":4},"generated":{"line":18,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":9},"generated":{"line":18,"column":13}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":4},"generated":{"line":18,"column":21}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":24}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":41,"column":36},"generated":{"line":18,"column":65}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":77}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":41,"column":48},"generated":{"line":18,"column":80}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":84}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":41,"column":53},"generated":{"line":18,"column":87}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":98}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":41,"column":64},"generated":{"line":18,"column":101}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":138}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":42,"column":33},"generated":{"line":18,"column":141}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":147}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":42,"column":39},"generated":{"line":18,"column":150}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":154}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":42,"column":44},"generated":{"line":18,"column":157}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":164}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":42,"column":51},"generated":{"line":18,"column":167}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":639}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":56,"column":32},"generated":{"line":18,"column":642}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":654}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":56,"column":44},"generated":{"line":18,"column":657}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":705}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":57,"column":37},"generated":{"line":18,"column":708}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":722}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":57,"column":51},"generated":{"line":18,"column":725}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":762}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":59,"column":32},"generated":{"line":18,"column":765}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":59,"column":41},"generated":{"line":18,"column":774}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":782}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":59,"column":49},"generated":{"line":18,"column":785}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":862}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":63,"column":34},"generated":{"line":18,"column":865}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":876}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":63,"column":45},"generated":{"line":18,"column":879}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":929}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":64,"column":39},"generated":{"line":18,"column":932}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":945}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":64,"column":52},"generated":{"line":18,"column":948}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":987}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":66,"column":34},"generated":{"line":18,"column":990}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":66,"column":43},"generated":{"line":18,"column":999}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1006}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":66,"column":50},"generated":{"line":18,"column":1009}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1092}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":70,"column":36},"generated":{"line":18,"column":1095}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1116}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":70,"column":57},"generated":{"line":18,"column":1119}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1673}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":87,"column":18},"generated":{"line":18,"column":1677}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":87,"column":46},"generated":{"line":18,"column":1705}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1706}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":87,"column":47},"generated":{"line":18,"column":1710}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1779}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":89,"column":38},"generated":{"line":18,"column":1782}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1803}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":89,"column":59},"generated":{"line":18,"column":1806}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1842}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":90,"column":31},"generated":{"line":18,"column":1845}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1866}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":90,"column":52},"generated":{"line":18,"column":1869}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1902}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":91,"column":25},"generated":{"line":18,"column":1906}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":91,"column":53},"generated":{"line":18,"column":1934}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":1935}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":91,"column":54},"generated":{"line":18,"column":1939}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2018}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":93,"column":38},"generated":{"line":18,"column":2021}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2042}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":93,"column":59},"generated":{"line":18,"column":2045}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2087}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":94,"column":38},"generated":{"line":18,"column":2090}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2111}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":94,"column":59},"generated":{"line":18,"column":2114}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2206}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":97,"column":31},"generated":{"line":18,"column":2209}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2230}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":97,"column":52},"generated":{"line":18,"column":2233}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2272}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":98,"column":31},"generated":{"line":18,"column":2275}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2296}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":98,"column":52},"generated":{"line":18,"column":2299}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2402}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":101,"column":25},"generated":{"line":18,"column":2406}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":101,"column":53},"generated":{"line":18,"column":2434}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2435}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":101,"column":54},"generated":{"line":18,"column":2439}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2518}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":103,"column":38},"generated":{"line":18,"column":2521}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2542}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":103,"column":59},"generated":{"line":18,"column":2545}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2587}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":104,"column":38},"generated":{"line":18,"column":2590}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2611}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":104,"column":59},"generated":{"line":18,"column":2614}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2660}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":105,"column":38},"generated":{"line":18,"column":2663}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2684}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":105,"column":59},"generated":{"line":18,"column":2687}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2779}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":108,"column":31},"generated":{"line":18,"column":2782}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2803}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":108,"column":52},"generated":{"line":18,"column":2806}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2845}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":109,"column":31},"generated":{"line":18,"column":2848}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2869}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":109,"column":52},"generated":{"line":18,"column":2872}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2915}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":110,"column":31},"generated":{"line":18,"column":2918}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":20},"generated":{"line":18,"column":2939}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":110,"column":52},"generated":{"line":18,"column":2942}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":40,"column":4},"generated":{"line":18,"column":3103}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":119,"column":3},"generated":{"line":19,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":120,"column":0},"generated":{"line":20,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":120,"column":0},"generated":{"line":20,"column":11}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":120,"column":0},"generated":{"line":20,"column":24}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":21,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":21,"column":1}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":21,"column":3}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":13},"generated":{"line":22,"column":0}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":13},"generated":{"line":22,"column":8}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":13},"generated":{"line":22,"column":21}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":13},"generated":{"line":22,"column":24}},{"source":"../src/kernels/webgl/conv_gpu.ts","name":null,"original":{"line":21,"column":13},"generated":{"line":22,"column":37}}],"sources":{"../src/kernels/webgl/conv_gpu.ts":"/**\n * @license\n * Copyright 2017 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\nimport {Conv2DInfo} from '../../ops/conv_util';\nimport {GPGPUProgram} from './gpgpu_math';\n\nexport class Conv2DProgram implements GPGPUProgram {\n  variableNames = ['x', 'W'];\n  outputShape: number[];\n  userCode: string;\n\n  constructor(convInfo: Conv2DInfo) {\n    this.outputShape = convInfo.outShape;\n    const padTop = convInfo.padInfo.top;\n    const padLeft = convInfo.padInfo.left;\n    const strideHeight = convInfo.strideHeight;\n    const strideWidth = convInfo.strideWidth;\n    const dilationHeight = convInfo.dilationHeight;\n    const dilationWidth = convInfo.dilationWidth;\n    const filterHeight = convInfo.filterHeight;\n    const filterWidth = convInfo.filterWidth;\n\n    const inputDepthNearestVec4 = Math.floor(convInfo.inChannels / 4) * 4;\n    const inputDepthVec4Remainder = convInfo.inChannels % 4;\n\n    this.userCode = `\n      const ivec2 strides = ivec2(${strideHeight}, ${strideWidth});\n      const ivec2 pads = ivec2(${padTop}, ${padLeft});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${filterHeight}; wR++) {\n          int xR = xRCorner + wR * ${dilationHeight};\n\n          if (xR < 0 || xR >= ${convInfo.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${filterWidth}; wC++) {\n            int xC = xCCorner + wC * ${dilationWidth};\n\n            if (xC < 0 || xC >= ${convInfo.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${inputDepthNearestVec4}; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if (${inputDepthVec4Remainder === 1}) {\n              dotProd +=\n                getX(batch, xR, xC, ${inputDepthNearestVec4}) *\n                getW(wR, wC, ${inputDepthNearestVec4}, d2);\n            } else if (${inputDepthVec4Remainder === 2}) {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, ${inputDepthNearestVec4}),\n                getX(batch, xR, xC, ${inputDepthNearestVec4} + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, ${inputDepthNearestVec4}, d2),\n                getW(wR, wC, ${inputDepthNearestVec4} + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if (${inputDepthVec4Remainder === 3}) {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, ${inputDepthNearestVec4}),\n                getX(batch, xR, xC, ${inputDepthNearestVec4} + 1),\n                getX(batch, xR, xC, ${inputDepthNearestVec4} + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, ${inputDepthNearestVec4}, d2),\n                getW(wR, wC, ${inputDepthNearestVec4} + 1, d2),\n                getW(wR, wC, ${inputDepthNearestVec4} + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `;\n  }\n}\n"},"lineCount":null}},"hash":"4539862a3465c8ccbf8bad8316be7ae7","cacheData":{"env":{}}}